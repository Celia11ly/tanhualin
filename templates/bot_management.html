<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot管理 - NGD智能客服对话模块</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary: #6366f1;
            --dark-card: #1f2937;
        }
        .bg-dark-card {
            background-color: var(--dark-card);
        }
        .text-primary {
            color: var(--primary);
        }
        .bg-primary {
            background-color: var(--primary);
        }
        .hover\:bg-primary\/90:hover {
            background-color: rgba(99, 102, 241, 0.9);
        }
        .focus\:ring-primary:focus {
            ring-color: var(--primary);
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <header class="mb-8">
            <div class="flex justify-between items-center mb-4">
                <h1 class="text-2xl font-bold">Bot管理</h1>
                <div class="flex gap-2">
                    <a href="/module/NGD智能客服对话模块" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md transition-colors duration-200 flex items-center gap-1">
                        <i class="fa fa-arrow-left"></i> 返回上一层
                    </a>
                    <a href="/" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md transition-colors duration-200 flex items-center gap-1">
                        <i class="fa fa-home"></i> 返回首页
                    </a>
                </div>
            </div>
            <div class="border-b border-gray-200 dark:border-gray-700">
                <nav class="flex space-x-8">
                    <a href="/module/Bot管理/基础编辑" class="pb-4 text-lg font-medium text-primary border-b-2 border-primary dark:text-primary transition-all duration-200" id="nav-basic-edit">
                        基础编辑
                    </a>
                    <a href="/module/Bot管理/会话树装配" class="pb-4 text-lg font-medium text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 border-b-2 border-transparent transition-all duration-200" id="nav-session-tree">
                        会话树装配
                    </a>
                    <a href="/module/Bot管理/知识选择" class="pb-4 text-lg font-medium text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 border-b-2 border-transparent transition-all duration-200" id="nav-knowledge-selection">
                        知识选择
                    </a>
                    <a href="/module/Bot管理/设置" class="pb-4 text-lg font-medium text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 border-b-2 border-transparent transition-all duration-200" id="nav-settings">
                        设置
                    </a>
                    <a href="/module/Bot管理/发布记录" class="pb-4 text-lg font-medium text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 border-b-2 border-transparent transition-all duration-200" id="nav-publish-records">
                        发布记录
                    </a>
                    <a href="/module/Bot管理/事件管理" class="pb-4 text-lg font-medium text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 border-b-2 border-transparent transition-all duration-200" id="nav-event-management">
                        事件管理
                    </a>
                </nav>
            </div>
        </header>

        <!-- 批量操作工具栏 -->
        <div id="batch-actions" class="flex flex-wrap justify-between items-center mb-6 p-4 bg-white dark:bg-dark-card rounded-lg shadow-sm border border-gray-200 dark:border-gray-800">
            <div class="flex items-center space-x-4 mb-3 sm:mb-0">
                <input type="checkbox" id="select-all-bots" class="w-5 h-5 text-primary focus:ring-primary border-gray-300 dark:border-gray-600 rounded">
                <label for="select-all-bots" class="text-sm text-gray-700 dark:text-gray-300">全选</label>
                <span id="selected-count" class="text-sm text-gray-500 dark:text-gray-400">已选择: 0</span>
            </div>
            <div class="flex flex-wrap gap-3">
                <button id="batch-delete-btn" class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-md transition-colors duration-200 flex items-center opacity-50 cursor-not-allowed" disabled>
                    <i class="fa fa-trash mr-1"></i> 批量删除
                </button>
                <button id="import-btn" class="px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-md transition-colors duration-200 flex items-center">
                    <i class="fa fa-upload mr-1"></i> 导入
                </button>
                <button id="export-btn" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors duration-200 flex items-center">
                    <i class="fa fa-download mr-1"></i> 导出
                </button>
                <button id="add-bot-btn" class="px-4 py-2 bg-primary hover:bg-primary/90 text-white rounded-md transition-colors duration-200 flex items-center">
                    <i class="fa fa-plus mr-1"></i> 新增Bot
                </button>
            </div>
        </div>

        <!-- 搜索和筛选 -->
        <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
            <div class="relative w-full sm:w-auto">
                <input type="text" id="bot-search" placeholder="搜索Bot..." class="pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent w-full sm:w-64 bg-white dark:bg-dark-card text-gray-900 dark:text-white">
                <i class="fa fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
            </div>
            <select id="status-filter" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-dark-card text-gray-900 dark:text-white">
                <option value="all">全部状态</option>
                <option value="draft">草稿</option>
                <option value="pending">待审核</option>
                <option value="published">已发布</option>
                <option value="rejected">已拒绝</option>
            </select>
        </div>

        <!-- Bot列表 -->
        <div id="bots-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Bot卡片将通过JavaScript动态生成 -->
        </div>

        <!-- 无搜索结果提示 -->
        <div id="no-search-results" class="hidden text-center py-12 col-span-full">
            <div class="text-gray-400 text-5xl mb-4"><i class="fa fa-search"></i></div>
            <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-2">没有找到匹配的Bot</h3>
            <p class="text-gray-500 dark:text-gray-400">请尝试使用其他搜索词或清除筛选条件</p>
        </div>
    </div>

    <script>
        // 模拟Bot数据
        const botData = [
            { id: 1, name: "客服助手", description: "用于处理常见客户问题的智能助手", status: "published", createTime: "2023-09-15", updateTime: "2023-10-10", version: "1.2.0", creator: "张三", avatar: "https://i.pravatar.cc/150?img=1" },
            { id: 2, name: "销售助手", description: "辅助销售团队进行产品介绍和咨询", status: "published", createTime: "2023-08-22", updateTime: "2023-10-05", version: "1.1.0", creator: "李四", avatar: "https://i.pravatar.cc/150?img=2" },
            { id: 3, name: "技术支持", description: "提供产品技术支持和故障排查", status: "pending", createTime: "2023-10-01", updateTime: "2023-10-03", version: "0.9.0", creator: "王五", avatar: "https://i.pravatar.cc/150?img=3" },
            { id: 4, name: "人力资源助手", description: "解答人力资源相关问题和政策", status: "published", createTime: "2023-07-18", updateTime: "2023-09-25", version: "1.0.1", creator: "赵六", avatar: "https://i.pravatar.cc/150?img=4" },
            { id: 5, name: "财务助手", description: "提供基础财务咨询和报销指导", status: "rejected", createTime: "2023-09-30", updateTime: "2023-10-02", version: "0.8.0", creator: "钱七", avatar: "https://i.pravatar.cc/150?img=5" },
            { id: 6, name: "培训助手", description: "辅助新员工培训和学习", status: "draft", createTime: "2023-10-05", updateTime: "2023-10-06", version: "0.5.0", creator: "孙八", avatar: "https://i.pravatar.cc/150?img=6" },
            { id: 7, name: "市场调研助手", description: "收集和分析市场调研数据", status: "published", createTime: "2023-06-15", updateTime: "2023-09-18", version: "1.3.0", creator: "周九", avatar: "https://i.pravatar.cc/150?img=7" },
            { id: 8, name: "产品咨询助手", description: "解答产品相关问题和功能介绍", status: "published", createTime: "2023-08-10", updateTime: "2023-10-08", version: "1.1.2", creator: "吴十", avatar: "https://i.pravatar.cc/150?img=8" },
            { id: 9, name: "预约助手", description: "处理用户预约和日程安排", status: "pending", createTime: "2023-09-20", updateTime: "2023-10-01", version: "0.9.5", creator: "郑一", avatar: "https://i.pravatar.cc/150?img=9" },
            { id: 10, name: "投诉处理助手", description: "辅助处理用户投诉和反馈", status: "published", createTime: "2023-07-05", updateTime: "2023-09-30", version: "1.2.1", creator: "王二", avatar: "https://i.pravatar.cc/150?img=10" },
            { id: 11, name: "订单查询助手", description: "帮助用户查询订单状态", status: "published", createTime: "2023-08-01", updateTime: "2023-10-04", version: "1.1.0", creator: "张三", avatar: "https://i.pravatar.cc/150?img=11" },
            { id: 12, name: "退款助手", description: "处理用户退款申请和查询", status: "pending", createTime: "2023-09-10", updateTime: "2023-10-02", version: "0.9.0", creator: "李四", avatar: "https://i.pravatar.cc/150?img=12" },
            { id: 13, name: "售后支持助手", description: "提供产品售后支持和维修咨询", status: "published", createTime: "2023-06-25", updateTime: "2023-09-20", version: "1.2.0", creator: "王五", avatar: "https://i.pravatar.cc/150?img=13" },
            { id: 14, name: "会员服务助手", description: "解答会员权益和服务问题", status: "published", createTime: "2023-07-30", updateTime: "2023-10-07", version: "1.1.5", creator: "赵六", avatar: "https://i.pravatar.cc/150?img=14" },
            { id: 15, name: "活动咨询助手", description: "提供公司活动和促销信息", status: "draft", createTime: "2023-10-03", updateTime: "2023-10-04", version: "0.6.0", creator: "钱七", avatar: "https://i.pravatar.cc/150?img=15" },
            { id: 16, name: "招聘助手", description: "解答招聘相关问题和流程", status: "rejected", createTime: "2023-09-15", updateTime: "2023-09-20", version: "0.8.5", creator: "孙八", avatar: "https://i.pravatar.cc/150?img=16" },
            { id: 17, name: "政策咨询助手", description: "解读公司政策和规章制度", status: "published", createTime: "2023-07-10", updateTime: "2023-09-28", version: "1.0.3", creator: "周九", avatar: "https://i.pravatar.cc/150?img=17" },
            { id: 18, name: "物流查询助手", description: "帮助用户查询物流信息", status: "published", createTime: "2023-08-15", updateTime: "2023-10-06", version: "1.1.0", creator: "吴十", avatar: "https://i.pravatar.cc/150?img=18" },
            { id: 19, name: "常见问题助手", description: "解答常见问题和FAQ", status: "pending", createTime: "2023-09-25", updateTime: "2023-10-01", version: "0.9.2", creator: "郑一", avatar: "https://i.pravatar.cc/150?img=19" },
            { id: 20, name: "反馈收集助手", description: "收集用户反馈和建议", status: "published", createTime: "2023-06-20", updateTime: "2023-09-15", version: "1.2.0", creator: "王二", avatar: "https://i.pravatar.cc/150?img=20" }
        ];

        // 渲染Bot列表
        function renderBotList(bots) {
            const container = document.getElementById('bots-container');
            const noResults = document.getElementById('no-search-results');

            if (bots.length === 0) {
                container.classList.add('hidden');
                noResults.classList.remove('hidden');
                return;
            }

            container.classList.remove('hidden');
            noResults.classList.add('hidden');

            container.innerHTML = '';

            bots.forEach(bot => {
                let statusClass = '';
                let statusText = '';

                switch (bot.status) {
                    case 'published':
                        statusClass = 'bg-green-100 text-green-800';
                        statusText = '已发布';
                        break;
                    case 'pending':
                        statusClass = 'bg-yellow-100 text-yellow-800';
                        statusText = '待审核';
                        break;
                    case 'rejected':
                        statusClass = 'bg-red-100 text-red-800';
                        statusText = '已拒绝';
                        break;
                    case 'draft':
                        statusClass = 'bg-gray-100 text-gray-800';
                        statusText = '草稿';
                        break;
                }

                const botCard = document.createElement('div');
                botCard.className = 'bg-white dark:bg-dark-card rounded-lg shadow-sm border border-gray-200 dark:border-gray-800 overflow-hidden transition-all duration-200 hover:shadow-md';
                botCard.innerHTML = `
                    <div class="p-5">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <img src="${bot.avatar}" alt="${bot.name}" class="w-12 h-12 rounded-full object-cover">
                                <div>
                                    <h3 class="font-medium text-lg">${bot.name}</h3>
                                    <span class="inline-block px-2 py-0.5 rounded-full text-xs font-medium ${statusClass}">${statusText}</span>
                                </div>
                            </div>
                            <input type="checkbox" class="bot-checkbox w-5 h-5 text-primary focus:ring-primary border-gray-300 dark:border-gray-600 rounded" data-id="${bot.id}">
                        </div>
                        <p class="text-gray-600 dark:text-gray-300 text-sm mb-4">${bot.description}</p>
                        <div class="grid grid-cols-2 gap-2 text-sm text-gray-500 dark:text-gray-400 mb-4">
                            <div>创建时间: ${bot.createTime}</div>
                            <div>更新时间: ${bot.updateTime}</div>
                            <div>版本: ${bot.version}</div>
                            <div>创建人: ${bot.creator}</div>
                        </div>
                        <div class="flex gap-2 mt-4">
                            <button class="edit-btn flex-1 px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors duration-200 text-sm flex items-center justify-center gap-1" data-id="${bot.id}">
                                <i class="fa fa-edit"></i> 编辑
                            </button>
                            <button class="delete-btn px-3 py-2 bg-red-500 hover:bg-red-600 text-white rounded-md transition-colors duration-200 text-sm flex items-center justify-center gap-1" data-id="${bot.id}">
                                <i class="fa fa-trash"></i> 删除
                            </button>
                        </div>
                        <div class="flex gap-2 mt-2">
                            <button class="detail-btn w-full px-3 py-2 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md transition-colors duration-200 text-sm flex items-center justify-center gap-1" data-id="${bot.id}">
                                <i class="fa fa-eye"></i> 查看详情
                            </button>
                        </div>
                    </div>
                `;

                container.appendChild(botCard);
            });

            // 添加事件监听器
            document.querySelectorAll('.bot-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', updateBatchActions);
            });

            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const botId = this.getAttribute('data-id');
                    editBot(botId);
                });
            });

            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const botId = this.getAttribute('data-id');
                    deleteBot(botId);
                });
            });

            document.querySelectorAll('.detail-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const botId = this.getAttribute('data-id');
                    viewBotDetail(botId);
                });
            });
        }

        // 更新批量操作按钮状态
        function updateBatchActions() {
            const checkboxes = document.querySelectorAll('.bot-checkbox:checked');
            const count = checkboxes.length;
            const batchDeleteBtn = document.getElementById('batch-delete-btn');
            const selectedCount = document.getElementById('selected-count');

            selectedCount.textContent = `已选择: ${count}`;

            if (count > 0) {
                batchDeleteBtn.disabled = false;
                batchDeleteBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                batchDeleteBtn.disabled = true;
                batchDeleteBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
        }

        // 全选/取消全选
        document.getElementById('select-all-bots').addEventListener('change', function() {
            const isChecked = this.checked;
            document.querySelectorAll('.bot-checkbox').forEach(checkbox => {
                checkbox.checked = isChecked;
            });
            updateBatchActions();
        });

        // 搜索功能
        document.getElementById('bot-search').addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase().trim();
            const statusFilter = document.getElementById('status-filter').value;
            filterBots(searchTerm, statusFilter);
        });

        // 状态筛选
        document.getElementById('status-filter').addEventListener('change', function() {
            const statusFilter = this.value;
            const searchTerm = document.getElementById('bot-search').value.toLowerCase().trim();
            filterBots(searchTerm, statusFilter);
        });

        // 筛选Bot
        function filterBots(searchTerm, statusFilter) {
            let filteredBots = botData;

            if (statusFilter !== 'all') {
                filteredBots = filteredBots.filter(bot => bot.status === statusFilter);
            }

            if (searchTerm) {
                filteredBots = filteredBots.filter(bot => 
                    bot.name.toLowerCase().includes(searchTerm) || 
                    bot.description.toLowerCase().includes(searchTerm) || 
                    bot.creator.toLowerCase().includes(searchTerm)
                );
            }

            renderBotList(filteredBots);
        }

        // 编辑Bot
        function editBot(id) {
            // 这里是编辑Bot的逻辑
            alert(`编辑Bot ID: ${id}`);
            // 实际应用中，这里会跳转到编辑页面或打开编辑模态框
        }

        // 删除Bot
        function deleteBot(id) {
            if (confirm('确定要删除这个Bot吗？')) {
                // 这里是删除Bot的逻辑
                alert(`删除Bot ID: ${id}`);
                // 实际应用中，这里会发送删除请求到服务器
                // 然后刷新列表
                renderBotList(botData.filter(bot => bot.id !== parseInt(id)));
            }
        }

        // 查看Bot详情
        function viewBotDetail(id) {
            // 这里是查看Bot详情的逻辑
            alert(`查看Bot详情 ID: ${id}`);
            // 实际应用中，这里会跳转到详情页面或打开详情模态框
        }

        // 批量删除
        document.getElementById('batch-delete-btn').addEventListener('click', function() {
            if (confirm('确定要删除选中的Bot吗？')) {
                const checkedIds = Array.from(document.querySelectorAll('.bot-checkbox:checked'))
                    .map(checkbox => parseInt(checkbox.getAttribute('data-id')));

                // 这里是批量删除的逻辑
                alert(`批量删除Bot IDs: ${checkedIds.join(', ')}`);
                // 实际应用中，这里会发送批量删除请求到服务器
                // 然后刷新列表
                renderBotList(botData.filter(bot => !checkedIds.includes(bot.id)));
                document.getElementById('select-all-bots').checked = false;
            }
        });

        // 新增Bot
        document.getElementById('add-bot-btn').addEventListener('click', function() {
            // 这里是新增Bot的逻辑
            alert('新增Bot');
            // 实际应用中，这里会跳转到新增页面或打开新增模态框
        });

        // 初始渲染
        renderBotList(botData);
    </script>
</body>
</html>